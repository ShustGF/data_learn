# **Задания для модуля 1:**
## 1. Разработка архитектуры аналитического решения ##
Необходимо нарисовать верхнеуровневую архитектуру аналитического решения по примеру теоретического видео, где я рассказывал об архитектуре ламоды. Необходимо использовать:
- Source Layer - слой источников данных
- Storage Layer - слой хранения данных 
- Business Layer - слой для доступа к данным бизнес пользователей

Необходимо использовать draw.io, Microsoft Visio Studio, Power Point или инструмент на выбор.
___
Разработана архитектура аналитического решания для задач поиска атак (брутфорс, DDoS и т.д.) со стороны злоумышлиника на сервера органинзации. Данное решение позволяется отбирать и предоставлять данные с каких IP адрессов происходят атаки и кому принадлежит данный адресс с помощью БД "RIPE".

![Архитектура аналитического решения](https://github.com/ShustGF/data_learn/blob/main/DE-101/Module1/Архитектура%20аналитического%20решения.png)

## 2. Аналитика в Exce ##
Используя данные Sample - Superstore.xls сделать:
- Использовать Lookup
- Построить Сводную таблицу
- Построить примеры отчетов
- Создать дашборд
- И другая функциональность Excel на ваш выбор.
___

# Постановка задачи перед построением дэшборда
1. Относительно доступных нам данных построить дэшборд  для аналитиков и их руководителей с целью быстрого доступа к данным с продажами по разным регионам.
2. На нём должны быть отображены следующие данные:

	а) KPI, такие как:
	* "Продажи", как общее число вырученных средств с продажи товаров;
	* "Прибыль", число полученных средств без учета себестоимости товара;
	* "Заказы", число полученных заказов в единицах.

	б) также данный дашборд должен графически отразить следующую информацию:
	* прибыль и продажи по категориям товаров, при этом, если прибыль отрицательная (т.е. товар продается в убыток) - выделить "красным" цветом
	* основное место должна занимать динамика дохода и прибыли, данный график должен отражать тенденцию дохода за определенный промежуток времени
	* ТОП-10 штатов по колличеству заказов
	* ТОП-10 городов по колличеству заказов
	* какой вид доставки предпочитают заказчики
	* загруженность менеджеров отвечающих за свои регионы
	* процент возвращаемых товаров;

	в) все графики должны изменяться по годам заказов товара, региону, категории товаров и возвращаемому товару;

	г) обязательно должен быть доступ ко всем графикам в отдельности и исходным данным;

	д) отдельный лист с основными показателями по месяцам в течении года;

	е) доступ к данным из пунктов "Г" и "Д", а также к самому дэшборду, должен осуществляться за счет перехода из листа с содержанием. 
    
3. Все данные перенести в репозиторий GIT.
___
# Выполнение поставленной задачи
1. Приводим таблицу в рабочий вид
	а) с целью понимания какой "Региональный менеджер" обрабатывал заказ, добавляем стоблец "Person" и с помощью функции `"=ПРОСМОТР(N2;People!$A$2:$B$5)"` объединяем с данными на листе "People", предворительно отсортировав данные и поменяв местами столбцы, и двойным кликом применяем для всех значений;
	б) замечаем, что в таблице с возвратами товаров много повторяющийся значений (~500), в связи с этим удаляем дубликаты из таблицы на листе "Returns" и сотрируем их по возрастанию;
	в) для того, чтобы понять возвращался товар или нет, создаем столбец "Returns" и вставляем следующую функцию `"=ЕСЛИОШИБКА(ВПР(B2;Таблица4;2;0);"No")"` , двойным кликом применяем для всех значений;
2.	Создаем лист "Содержание" со списком и переходами к исходным данным, для этого доваляем к объекту "Гиперссылку".("Гиперссылка..." -> "Место в документе" -> "Выбираем из списка требуемые данные(Orders\People\Returns)". И делаем так для каждого пункта.
3. В рамках выполнения задания "2а" создаем сводные таблицы на отдельных листах по таблице "Orders", после чего на каждом листе в поле `"ЗНАЧЕНИЕ"` заносим требуемое поле. Далее в отдельной ячейке ссылаемся на полученную ячейку сводной таблицы, согласно получаемой формуле `"=ПОЛУЧИТЬ.ДАННЫЕ.СВОДНОЙ.ТАБЛИЦЫ("Sales";$A$3)"`. Далее по полученной ячейке создаем гистограмму и убираем на ней все(либо переводим в цвет фона), оставляя только подпись со значением и заголовок. Это позволит применять фильтры на данных показателях на дэшборде.
4. По пунтку "2б1" создаем отдельную сводную таблицу по таблице "Orders", в окно `"ЗНАЧЕНИЯ"` добавляем значения "Sales" и "Profit", в окно `"СТРОКИ"` "Category" и "Sub-Category". Чтобы показать отрицательную прибыль относительно продаж, целесообразно применить "Пулевую(Градусную) диаграмму". Для это создаем линейчатую диаграмму по всем данным, далее выделяем вершины данной диаграммы и в праметрах ряда выбираем построить ряд по вспомогательной оси. Из-за этого диаграмма съезжает. После чего выбираем и приводим к общему виду основную и вспомогательную ось (выбираем границы миниму и максиму), после чего данные приводятся к общему виду, но отрицательные данные залазят на ось с названием категорий. Чтобы это убрать, выбираем данную ось и в параметрах оси положение подписи нужно поставить `"Внизу"`. После этого нужно сделать так, чтобы отрицательные значения перекрашивались в красный цвет. Выбираем значения "Profit" в параметрах заливка и граница, нужно найти пункт `"Инверсия для чисел >0"`, после чего появится дополнительный выбор цвета в поле "Цвет" , выставляем там "Красный".
5. Для пункта "2б2", требуется построить линию тенденции "продаж".  Для этого создаем отдельную сводную таблицу по таблице "Orders" , в окно `"ЗНАЧЕНИЯ"` добавляем значения "Sales" и "Profit", в окно `"СТРОКИ"` - "Годы" и "Order Date", и по полученным данным строим линейный график. Выбирает требуемую линию "Продажи" и ПКМ , в свойствах выбираем "Добавить линию тренда.."
6. Для остальных пунктов пункта "2б" создаем отдельную сводную таблицу по таблице "Orders" и строим соответствующие им диаграммы. 
7. Со всех лисов копируем диаграммы и графики на основной дэшборд и размещаем их на нём.
8. Добавляем требуемые "фильтры", для этого выбираем любой график и в свойствах находим `"Показать список полей"`. Находим требуемые поля и ПКМ , в свойствах поля выбираем `"Добавить как срез"`, а для поля "Order Date" выбираем `"Добавить как временную шкалу"` и размещаем данные окна на дэшборде. 
9. Повторяем выполнение пункта 2 для всех листов с графиками и дэшбордом.
10. Для пункта "2д" создаем отдельную сводную таблицу по таблице "Orders" и выводим на экран таблицу основных показателей годов с разбивкой по месяцам. И для того, чтобы выделить какие-либо отклонения, для каждой таблицы выбираем `"Условное форматирование"` -> `"Цветовые шкалы"`. Это позволит более быстро ориентироваться в таблице.
# Итог задания 2

![DASHBORD](https://github.com/ShustGF/data_learn/blob/main/DE-101/Module1/DASHBOARD.PNG)
